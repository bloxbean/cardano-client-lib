package com.bloxbean.cardano.client.plutus.util;

import com.bloxbean.cardano.client.plutus.blueprint.model.PlutusVersion;
import com.bloxbean.cardano.client.plutus.spec.PlutusScript;
import com.bloxbean.cardano.client.plutus.spec.PlutusV1Script;
import com.bloxbean.cardano.client.plutus.spec.PlutusV2Script;
import org.junit.jupiter.api.Test;

import static org.assertj.core.api.Assertions.assertThat;

public class PlutusUtilTest {

    @Test
    void isDoubleEncoded_doubleEncoded() {
        String cborHex = "5903585903550100003323232323232323232323232323232323232322223232323232323253330153370e9000001099191919299980c99b874800000854ccc064cdc39998079bab301e30133018301e004375c603c0026eb8c078015200215333019332301322533301d00114a02a6646603a0022944c00cc0840044c008c07c0048cdd7980f980c8008079bac301e3018301e301800c149854cc07d241115554784f206e6f7420636f6e73756d65640016153301f01616153301f01716301f002301f0013754603660320026028010264646464a66603266e1d2000002153330193370e66601e6eacc078c04cc060c078010dd7180f0009bae301e00532337029000000a40042930a9980f80b0b0a9980f80b8b180f801180f8009baa301b30190013014008301b002301b001375400ca66602266e1d2000002132325333013337126e340052040132324994ccc054004526153301a016163016003153301901716375c002602c0022a66602266e1d2002002132325333013337126e340052040132324994ccc054004526153301a016163016003153301901716375c002602c0022a6602e92013f7265616368656420656e64206f662073756d207768696c65207374696c6c206e6f7420686176696e6720666f756e642074686520636f6e7374727563746f720016301700230170013754004444666600800490001199980280124000eb4dd5800801918011ba900122223300522533300f00110051533300e3375e602c602600200c26008602a602600226004602200200246460044660040040024600446600400400246014600400246012600400246010601000292103323034004901435061747465726e206d61746368206661696c75726520696e2027646f2720626c6f636b206174207372632f5368617265642f436865636b732e68733a33373a332d313900230093754002ae6955cfa481317074727946726f6d2850446174615265636f72645b5d293a206c697374206973206c6f6e676572207468616e207a65726f0057449201327074727946726f6d28546f6b656e4e616d65293a206d757374206265206174206d6f7374203332204279746573206c6f6e67005742ae7155cf2ab9d4c12bd8799fd8799f58200a61225b2d38afdea88fa3ed23002caadeb4a286d2b905f2e87733bbc9d9c282ff03ff0001";
        boolean isDoubleEncoded = PlutusUtil.isDoubleEncoded(cborHex);

        assertThat(isDoubleEncoded).isTrue();
    }

    @Test
    void isDoubleEncoded_singleEncoded() {
        String cborHex = "5903550100003323232323232323232323232323232323232322223232323232323253330153370e9000001099191919299980c99b874800000854ccc064cdc39998079bab301e30133018301e004375c603c0026eb8c078015200215333019332301322533301d00114a02a6646603a0022944c00cc0840044c008c07c0048cdd7980f980c8008079bac301e3018301e301800c149854cc07d241115554784f206e6f7420636f6e73756d65640016153301f01616153301f01716301f002301f0013754603660320026028010264646464a66603266e1d2000002153330193370e66601e6eacc078c04cc060c078010dd7180f0009bae301e00532337029000000a40042930a9980f80b0b0a9980f80b8b180f801180f8009baa301b30190013014008301b002301b001375400ca66602266e1d2000002132325333013337126e340052040132324994ccc054004526153301a016163016003153301901716375c002602c0022a66602266e1d2002002132325333013337126e340052040132324994ccc054004526153301a016163016003153301901716375c002602c0022a6602e92013f7265616368656420656e64206f662073756d207768696c65207374696c6c206e6f7420686176696e6720666f756e642074686520636f6e7374727563746f720016301700230170013754004444666600800490001199980280124000eb4dd5800801918011ba900122223300522533300f00110051533300e3375e602c602600200c26008602a602600226004602200200246460044660040040024600446600400400246014600400246012600400246010601000292103323034004901435061747465726e206d61746368206661696c75726520696e2027646f2720626c6f636b206174207372632f5368617265642f436865636b732e68733a33373a332d313900230093754002ae6955cfa481317074727946726f6d2850446174615265636f72645b5d293a206c697374206973206c6f6e676572207468616e207a65726f0057449201327074727946726f6d28546f6b656e4e616d65293a206d757374206265206174206d6f7374203332204279746573206c6f6e67005742ae7155cf2ab9d4c12bd8799fd8799f58200a61225b2d38afdea88fa3ed23002caadeb4a286d2b905f2e87733bbc9d9c282ff03ff0001";
        boolean isDoubleEncoded = PlutusUtil.isDoubleEncoded(cborHex);

        assertThat(isDoubleEncoded).isFalse();
    }

    @Test
    void getPlutusScript_v2_doubleEncoded() {
        String cborHex = "5903585903550100003323232323232323232323232323232323232322223232323232323253330153370e9000001099191919299980c99b874800000854ccc064cdc39998079bab301e30133018301e004375c603c0026eb8c078015200215333019332301322533301d00114a02a6646603a0022944c00cc0840044c008c07c0048cdd7980f980c8008079bac301e3018301e301800c149854cc07d241115554784f206e6f7420636f6e73756d65640016153301f01616153301f01716301f002301f0013754603660320026028010264646464a66603266e1d2000002153330193370e66601e6eacc078c04cc060c078010dd7180f0009bae301e00532337029000000a40042930a9980f80b0b0a9980f80b8b180f801180f8009baa301b30190013014008301b002301b001375400ca66602266e1d2000002132325333013337126e340052040132324994ccc054004526153301a016163016003153301901716375c002602c0022a66602266e1d2002002132325333013337126e340052040132324994ccc054004526153301a016163016003153301901716375c002602c0022a6602e92013f7265616368656420656e64206f662073756d207768696c65207374696c6c206e6f7420686176696e6720666f756e642074686520636f6e7374727563746f720016301700230170013754004444666600800490001199980280124000eb4dd5800801918011ba900122223300522533300f00110051533300e3375e602c602600200c26008602a602600226004602200200246460044660040040024600446600400400246014600400246012600400246010601000292103323034004901435061747465726e206d61746368206661696c75726520696e2027646f2720626c6f636b206174207372632f5368617265642f436865636b732e68733a33373a332d313900230093754002ae6955cfa481317074727946726f6d2850446174615265636f72645b5d293a206c697374206973206c6f6e676572207468616e207a65726f0057449201327074727946726f6d28546f6b656e4e616d65293a206d757374206265206174206d6f7374203332204279746573206c6f6e67005742ae7155cf2ab9d4c12bd8799fd8799f58200a61225b2d38afdea88fa3ed23002caadeb4a286d2b905f2e87733bbc9d9c282ff03ff0001";
        String scriptHash = "5c17ca2cb0ed76c8c6345f7db447d1c8f260e032cd2fb8267a17aa3e";
        PlutusScript plutusScript = PlutusUtil.getPlutusScript(scriptHash, cborHex).get();

        System.out.println(plutusScript.getCborHex());

        assertThat(plutusScript).isNotNull();
        assertThat(plutusScript).isInstanceOf(PlutusV2Script.class);
    }

    @Test
    void getPlutusScript_v2_singleEncoded() {
        String compiledCode = "5903550100003323232323232323232323232323232323232322223232323232323253330153370e9000001099191919299980c99b874800000854ccc064cdc39998079bab301e30133018301e004375c603c0026eb8c078015200215333019332301322533301d00114a02a6646603a0022944c00cc0840044c008c07c0048cdd7980f980c8008079bac301e3018301e301800c149854cc07d241115554784f206e6f7420636f6e73756d65640016153301f01616153301f01716301f002301f0013754603660320026028010264646464a66603266e1d2000002153330193370e66601e6eacc078c04cc060c078010dd7180f0009bae301e00532337029000000a40042930a9980f80b0b0a9980f80b8b180f801180f8009baa301b30190013014008301b002301b001375400ca66602266e1d2000002132325333013337126e340052040132324994ccc054004526153301a016163016003153301901716375c002602c0022a66602266e1d2002002132325333013337126e340052040132324994ccc054004526153301a016163016003153301901716375c002602c0022a6602e92013f7265616368656420656e64206f662073756d207768696c65207374696c6c206e6f7420686176696e6720666f756e642074686520636f6e7374727563746f720016301700230170013754004444666600800490001199980280124000eb4dd5800801918011ba900122223300522533300f00110051533300e3375e602c602600200c26008602a602600226004602200200246460044660040040024600446600400400246014600400246012600400246010601000292103323034004901435061747465726e206d61746368206661696c75726520696e2027646f2720626c6f636b206174207372632f5368617265642f436865636b732e68733a33373a332d313900230093754002ae6955cfa481317074727946726f6d2850446174615265636f72645b5d293a206c697374206973206c6f6e676572207468616e207a65726f0057449201327074727946726f6d28546f6b656e4e616d65293a206d757374206265206174206d6f7374203332204279746573206c6f6e67005742ae7155cf2ab9d4c12bd8799fd8799f58200a61225b2d38afdea88fa3ed23002caadeb4a286d2b905f2e87733bbc9d9c282ff03ff0001";
        String scriptHash = "5c17ca2cb0ed76c8c6345f7db447d1c8f260e032cd2fb8267a17aa3e";
        PlutusScript plutusScript = PlutusUtil.getPlutusScript(scriptHash, compiledCode).get();

        System.out.println(plutusScript.getCborHex());

        assertThat(plutusScript).isNotNull();
        assertThat(plutusScript).isInstanceOf(PlutusV2Script.class);
    }

    @Test
    void getPlutusScript_v1_doubleEncoded() {
        String cborHex = "59236759236401000033232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323222223333222232323232323232323232323232323232323232323253330493370e90000010a99982499999811182600700c899991128008a5114a029404ccc88940045280a5114a02666444a00229405280a51153330493302c37526eb8c130018dd618260068a4c2c2c2a66609266e1d200400213232533304b53303c3302e37526eb8c13800cdd61827007899b87302f3758609c01e9001099191919299982799b874800000854ccc13ccdd798290029829000899191919191919191919191919299982e1822982f8008a99982e1822982f982f0048a99982e19b8f323232533305f3370e900000109bae30620011630620023062001375460be0106eb8c17c01c54ccc170ccc124dd7182f80b8289bab305f00c1533305c3375e60be01260be60bc0022930b0b0b0b0b182e800982e000982d800982d000982c800982c000982a191919299982c19b87480080084c16c00458c16c008c16c004dd51919191919829182199182e982e182c8009982a982b119baf305d3059001305d305c00c375860b804800ea6660b066e1d2000002132323232324994ccc17400452616305d002305d001305b002305b001153330583370e9001001099191924ca6660b60022930b182d801182d8008a99982c19b87480100084c8c8c8c926533305c001149858c17000cdd7000982d8008b182d801182d8009baa3304e303f3230593058305500133051305223375e60b260aa00260b260b00106eb0c16008000cc8c8c94ccc15ccdc3a400000420022c60b400460b40026ea808cc8c8c94ccc158cdc3a400000420022c60b200460b20026ea8c8c8c8c8cc140c104ccc10cc168020018dd6182d010802a99982b19b87480000084c8c8c8c8c926533305b001149858c16c008c16c004c164008c16400454ccc158cdc3a4004004264646493299982c8008a4c2c60b200460b20022a6660ac66e1d20040021323232324994ccc16800452616305a003375c00260b20022c60b200460b20026ea8cc130c0f4ccc0fcc158010008dd6182b00e8009bac305501533045375c60a801808c60a4002609c60a460a200a2a66609e66ebcc148014c148c14400454ccc13ccc0d8dd7182918288051bab30523051304e305230510051533304f33303c375c60a460a201400c6eacc148c144c138c148c14401452616161533304f32323253330523370e90020010a99982919b8f375c60aa0026e50dd7182a8050a511614a060aa00460aa0026ea8078526161533304f3370e900200109919191919191919299982b98269820182d0008a99982b99b8f375c60b400e6e50dd7182d0078a99982b99b87332232323233303122533305e3371e0086eb8c18c0044ccc0cc894ccc180cdc78029bae30650011337000046eb4c1900044008008dd598310008801240000086eb8c178c174008dd7182e800982c001182d009991bab305b305a30570013305330542323375e01c0026460b860b000260b660ae0026eb0c168084c8cdc199b81375a60b600266e14dd6982d8009bad305b305a001375a60b660b400260ac646464646606666e0c008cccc15c0c400800520023370600266660ae062004002900119b82375a60ba60b80066eb4c174c170008cdc019b82375a60b80046eb4c170c16c004cdc11bad305c001375a60b860b600460ae60b600a60ac6605e6eb4c1680192002153330573375e60b401a60b40122a6660ae6607c6eb8c168c164048dd5982d182c982b182d182c8068a99982b9998221bae305a305901200e375660b460b260ac60b460b201a2930b0b0a99982b991919299982d19b874801000854ccc168cdc79bae305d00137286eb8c1740485288b0a50305d002305d001375404c2930b0b0b0b182c000982b800982b000982a800982a00098298009827991919299982999b87480080084c15800458c158008c158004dd51919191919826981f19182c182b982a000998281828919baf305830540013058007375860ae03e00aa6660a666e1d2000002132323232324994ccc160004526163058002305800130560023056001153330533370e9001001099191924ca6660ac0022930b182b001182b0008a99982999b87480100084c8c8c8c9265333057001149858c15c00cdd7000982b0008b182b001182b0009baa33049303a323054305330500013304c304d23375e60a860a000260a80066eb0c14c06c004dd618290090a99982799baf30520053052001132323232323232323232323232323232323232323232323253330673050306a001153330673304e375c60d460d20446eacc1a805c54ccc19ccc13cc1a8c1a403cdd718350038a99983399baf306a3069008306a3069001153330675330583375e60d401c60d402a2a660b066ebcc1a8034c1a805054cc160cdd7983500618350098a9982c19baf306a00b306a01215330583375e60d401460d40222a660b066ebcc1a8024c1a80404cdd7983500418350078a4c2c2c2c2c2c60d000260ce00260cc00260ca00260c800260c600260be646464a6660c666e1d2002002130660011630660023066001375464646464660ba609c6460d060ce60c8002660c060c2466ebcc1a0c190004c1a0c19c05cdd61833817809a99983199b87480000084c8c8c8c8c9265333068001149858c1a0008c1a0004c198008c19800454ccc18ccdc3a400400426464649329998330008a4c2c60cc00460cc0022a6660c666e1d20040021323232324994ccc19c004526163067003375c00260cc0022c60cc00460cc0026ea8cc164c128c8c190c18cc180004cc170c1748cdd798321830000983218318099bac306302b00f30610013060001305f001305e001305d001305c0013058323232533305c3370e90010010982f8008b182f801182f8009baa32323232330563047333049306000e333059050375c60c060be0306eacc180034dd61830013806299982e19b87480000084c8c8c8c8c9265333061001149858c184008c184004c17c008c17c00454ccc170cdc3a4004004264646493299982f8008a4c2c60be00460be0022a6660b866e1d20040021323232324994ccc180004526163060003375c00260be0022c60be00460be0026ea8cc148c10cccc114c170028ccc154130dd7182e182d80a1bab305c009375860b804601060b400260b200260b000260ae00260ac00260aa00260a2646464a6660aa66e1d200200213058001163058002305800137540426eb0c150050c148004c138c148c14401454ccc13ccdd79829002982918288008a9998279981b1bae3052305100a375660a460a2609c60a460a200a2a66609e6660786eb8c148c144028018dd5982918289827182918288028a4c2c2c2a66609e646464a6660a466e1d2004002153330523371e6eb8c154004dca1bae305500a14a22c2940c154008c154004dd500f0a4c2c60a400460a40026ea8c13cc138010cdd2a4000660846ea4dd718270018218b1824998229826982600b1bac304d01537286eb8c13000454ccc124ccccc088c1300380644ccc88940085288a5014a02666444a00429405288a501333222500214a02940528899192999825a9981e198171ba9375c609c0046eb0c13803c4cdc398179bac304e00f480084c94ccc130cdc4240006eb4c13c0104c8c8c8c8c94ccc144cdc3a40040042a6660a2608e660706eb8c150c14c030dd5982a00c899192999829991919299982b19b874801000854ccc158cdc79bae305900100b14a22c2940c164008c164004dd50110a4c2646464646464646464646464646464a6660c4a660a6609660ca0102609660ca0022a6660c466e3cdd7183280700b8a99983119b8f375c60ca00e02e2a6660c466e1cdd6983280299b80375a60ca0186eb4c19406854ccc188cdc39bad3065006337006eb4c194034dd6983280d0a99983129982999b89375a60ca0426eb4c1940184cdc49bad3065006375a60ca0402a6660c4a660a666ebcc19402cc19401054cc14ccdd7983280518328018a9982999baf3065009306500213375e60ca60c801060ca60c80022a6660c466660a06e3cdd7183280b1b8f375c60ca60c802c6e1cdd698328031bab3065306430613067533306301516132533306400113048306601616306401514985858585858585858c18c004c188004c184004c180004c17c004c178004c168c8c8c94ccc178cdc3a4004004260c20022c60c200460c20026ea8c8c8c8c8cc160c124ccc12cc188038030dd618310149bac3062022533305e3370e90000010991919191924ca6660c60022930b18318011831800983080118308008a99982f19b87480080084c8c8c9265333061001149858c184008c18400454ccc178cdc3a40080042646464649329998310008a4c2c60c40066eb8004c18400458c184008c184004dd51982a1822999823982f0050041bac305e025375860bc03c60b800260b600260b400260b200260b000260ae00260a6646464a6660ae66e1d20020021305a00116305a002305a00137540466608e6eb8c158c154038020c150004c140c150c14c01c5854ccc144cc0e0dd7182a18298061bab305401915333051333303f371e6eb8c150014dc79bae30543053005370e6eb4c150024dd5982a18299828182b29998290020b09929998298008981b982a8028b182980209919191919191919299982c99b87480000084c8c8c8c8c8c8c8c8c94ccc1894cc14cc12cc194c1900204c12cc194c19002454ccc1894cc14ccdc39bad3065005375a60ca034266e1cdd698328031bad306501a153330623371e6eb8c19401c05c54ccc188c12cc19400454ccc1894cc14ccdc49bad3065021375a60ca00c266e24dd698328031bad3065020153330625330533375e60ca0080902a660a666e1cdd69832801a4000266e1cdd69832801240002a6660c466609e6eb8c19407415cdd598328080a99983119baf3065018306500a153330623304a3065009375c60ca00e2646464a6660ca66e1d200200215333065304e306830670041498584c94ccc198cdc81bae306900b001153330663304e3069306800500114985858dd71834000983400118340009baa30650081616161616161616163063001306200130610013060001305f001305e001305a323232533305e3370e9001001098308008b183080118308009baa3232323233058304933304b306200e00b375860c4052014a6660bc66e1d2000002132323232324994ccc18c0045261630630023063001306100230610011533305e3370e9001001099191924ca6660c20022930b183080118308008a99982f19b87480100084c8c8c8c9265333062001149858c18800cdd700098308008b183080118308009baa330543045333047305e00a007375860bc04a00c646464a6660ba66e1d2000002100116306000230600013754052646464a6660b866e1d2000002100116305f002305f001375464646464660ac608e66609260c00180146eb0c18009c0214ccc170cdc3a4000004264646464649329998308008a4c2c60c200460c200260be00460be0022a6660b866e1d200200213232324994ccc17c00452616305f002305f0011533305c3370e900200109919191924ca6660c00022930b18300019bae001305f00116305f002305f0013754660a4608666608a60b801000c6eb0c17008c01054ccc164cdc3a40040042646464646464646464646464646464646464646464a6660dc60ae60e201e2a6660dca660be66e1cdd698388029bad307102613370e6eb4c1c4018dd698388130a99983719b8f375c60e200e0462a6660dc60ae60e20022a6660dca660be66e24dd698388169bad30710061337126eb4c1c4018dd698388160a99983729982f99baf3071004054153305f3370e6eb4c1c400d200013370e6eb4c1c400920001533306e53305f3375e60e202a60e201c2a660be66ebcc1c4050c1c403454cc17ccdd7983880998388060a9982f99baf3071012307100b153305f3375e60e202260e20142a660be66ebcc1c4040c1c40244cdd7983880798388040a9998371982a9bae30713070029375660e20382a6660dc66ebcc1c4090c1c405854ccc1b8cc158c1c4c1c0020dd718388038a9998371982b18389838000991919299983899b87480000084dd7183a0008b183a001183a0009baa3071307000f1533306e53305f337206eb8c1c4054dd71838803899b90375c60e200e646464a6660e266e1d20000021375c60e80022c60e800460e80026ea8c1c4c1c003c526161616161616161616161616306f001306e001306d001306c001306b001306a0013066323232533306a3370e9001001098368008b183680118368009baa32323232330643055333057306e01a017375860dc06a02ca6660d466e1d2000002132323232324994ccc1bc00452616306f002306f001306d002306d0011533306a3370e9001001099191924ca6660da0022930b183680118368008a99983519b87480100084c8c8c8c926533306e001149858c1b800cdd700098368008b183680118368009baa330603051333053306a016013375860d406202460d000260ce00260cc00260ca00260c800260c600260be646464a6660c666e1d2002002130660011630660023066001375464646464660ba609c6660a060ce0266660c00ae6eb8c19cc19807cdd598338091bac306702e00f53330633370e90000010991919191924ca6660d00022930b18340011834000983300118330008a99983199b87480080084c8c8c9265333066001149858c198008c19800454ccc18ccdc3a40080042646464649329998338008a4c2c60ce0066eb8004c19800458c198008c198004dd51982c9825199826183180799982e0299bae3063306201b375660c601c6eb0c18c0a802cc184004c180004c17c004c178004c174004c170004c160c8c8c94ccc170cdc3a4004004260be0022c60be00460be0026ea80a04c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c94ccc1bcc160c1c803c54ccc1bd4cc180cdc39bad3072005375a60e404e266e1cdd698390031bad30720271533306f3371e6eb8c1c801c09054ccc1bcc160c1c800454ccc1bd4cc180cdc49bad307202e375a60e400c266e24dd698390031bad307202d1533306f5330603375e60e40080aa2a660c066e1cdd69839001a4000266e1cdd69839001240002a6660dea660c066ebcc1c8054c1c803854cc180cdd7983900a18390068a9983019baf3072013307200c15330603375e60e402460e40162a660c066ebcc1c8044c1c802854cc180cdd798390081839004899baf307200f30720081533306f33056375c60e460e20546eacc1c807454ccc1bccdd7983901280b0a999837982c183918388078a9998379982b983918388041bae30720071533306f3058307230710011533306f337206eb8c1c8038dd718390038a4c2c2c2c2c2c2c2c2c2c2c2c2c2c60e000260de00260dc00260da00260d800260d600260ce646464a6660d666e1d20020021306e00116306e002306e001375464646464660ca60ac6660b060de0360306eb0c1bc0d805d4ccc1accdc3a4000004264646464649329998380008a4c2c60e000460e000260dc00460dc0022a6660d666e1d200200213232324994ccc1b800452616306e002306e0011533306b3370e900200109919191924ca6660de0022930b18378019bae001306e00116306e002306e0013754660c260a46660a860d602e0286eb0c1ac0c804cc1a4004c1a0004c19c004c198004c194004c190004c180c8c8c94ccc190cdc3a4004004260ce0022c60ce00460ce0026ea8c8c8c8c8cc178c13cccc144c1a0050ccc184160dd7183418338101bab3068013375860d005e020a6660c866e1d2000002132323232324994ccc1a4004526163069002306900130670023067001153330643370e9001001099191924ca6660ce0022930b183380118338008a99983219b87480100084c8c8c8c9265333068001149858c1a000cdd700098338008b183380118338009baa3305a304b33304d306401033305d054375c60c860c60386eacc19003cdd61832015806183100098308009830000982f800982f000982e800982c991919299982e99b87480080084c18000458c180008c180004dd5014982e000982e001182e0009baa3059006375860b0030660906eb8c15cc15803c024cc11cdd7182b007024182a0009828182a18298038b0b182a001182a0009baa3051305000533304922253330510011048133300230530012330480013300400330530021330030023052001232533304f30453375e60a40026460a6609e00260a460a200a244a0022646464a6660a466e1d2000002153330523232323253330563370e90020010a99982b19b8f375c60b2002016294458528182c801182c8009baa3232323200553330563370e90000010991919191924ca6660b60022930b182d801182d800982c801182c8008a99982b19b87480080084c8c8c9265333059001149858c164008c16400454ccc158cdc3a400800426464646493299982d0008a4c2c60b40066eb8004c16400458c164008c164004dd5000998259bae3055001375860aa02a24460046466e9520003304c0083304c00104d3304d375c60ae0066eb0c15c05c489400458c154008c154004dd518291828982880098268009bac3050017304b304f0081637286eb8c13800858c124cc114c134c130058dd6182680a98258008b182600118260009baa0143047001304600130450013044001304300130420013041001303d00e303f001303e001303d001303c001303b001303a001303900130380013034303800130330013232323200853330333370e9000001099191919191919191919191919191919191919191919191919191924ca66609c0022930b18270019bae001304d001304b003375c002609400260900046090002608c0066eb8004c114004c10c00cdd6800982100098200019bad001303f001303d003375a002607800260740066eb4004c0e4004c0dc00cdd6800981b0008b181b001181b0009baa0043232323200753330333370e90000010991919191924ca6660700022930b181c001181c000981b001181b0008a99981999b87480080084c8c8c9265333036001149858c0d8008c0d800454ccc0cccdc3a400800426464646493299981b8008a4c2c606e0066eb8004c0d800458c0d8008c0d8004dd500199191919003299981999b87480000084c926533303400114985854ccc0cccdc3a4004004264646464646464646493299981e0008a4c2c6078004607800260740066eb8004c0e4004c0dc00cdd6800981b0008a99981999b87480100084c8c8c8c8c8c9265333039001149858c0e4008c0e4004c0dc00cdd7000981b0008b181b001181b0009baa002001230282225333030001100213300333004002303200130310012222323253330303370e00a008266e0801400c54ccc0c000854ccc0c00044cdc119980319b8300548010cdc1802240080069002099980319b830054801001000c54ccc0c00044ccc018014cdc1802240080062a66606066e200140104ccc018cdc199b810040054801001400c4ccc018cdc199b810050044801001000cc01800cc01400c8cdc399b85001480112000223374a9000198109ba800233021375000204444646464646464646464646464a66606a6464a6605066022607400460740022660246074607200260746072004606a01e606866e9520003302c3374a90001981619ba5480000b4cc0b005c0b4cc0b0cdd2a40006605866e9520023302c375000805a66058604a9400b40b44889400c54ccc0d4cc88c00888888c8c8c8c94cc0c4cdc499b8132323253330433370e900100109bad3046001163046002304600137546086004646464a66608666e1d20020021375a608c0022c608c004608c0026ea8c10c00ccdc08030038a9981899802929981919b89480000084cdc4001000899b894800000454cc0c4cdc499b803370001266e0800402001cc8c8c94ccc10ccdc3a400400426eb4c11800458c118008c118004dd51821801899b8932323253330433370e900100109bad304600116304600230460013754608600466e00cdc000499b820010080063370866e04c8c8c94ccc108cdc3a400400426eb4c11400458c114008c114004dd51821001004003981e98209820001181e1820000981d8031199998008028012400000844a00201c2444a0042a66606a664460044444464646464a6606266e24cdc0991919299982199b87480080084dd698230008b182300118230009baa304300232323253330433370e900100109bad304600116304600230460013754608600666e0401801c54cc0c4cc01494cc0c8cdc4a4000004266e200080044cdc4a40000022a6606266e24cdc019b800093370400201000e646464a66608666e1d20020021375a608c0022c608c004608c0026ea8c10c00c4cdc4991919299982199b87480080084dd698230008b182300118230009baa30430023370066e00024cdc100080400319b8433702646464a66608466e1d20020021375a608a0022c608a004608a0026ea8c10800802001cc0f4c104c100008c0f0c100004c0ec0188ccccc004014008010cdc0002001912800807091128008b19b80002001375a606c0106eb4c0d4020dd6981a00418190009818800981800098178009817000981680098160009814000911919299981519b8733009302d002302d001480005288a99981519b8733009302d002302d0014800854cc018c020c0b4c0b00084c080c020c0b4c0b000454ccc0a8cdc39980498168011816800a4008294058c0a0008c09c00888c8c94ccc0a4cdc39980418160011816000a4000294454ccc0a4cdc39980418160011816000a40042a6600a600e605860560022603e600e605860560042a66605266e1ccc020c0b0008c0b0005200414a02c604e004604c0044466604c00400600229448cdc398141baa00148008894ccc08ccc00c008004520001533302333004002001148008520042232323253330253370e90000010991919299981419b87480000085280a51302b002302b00137540082a66604a66e1d2002002132323253330283370e90000010a50153330283370e90020010a511337106eb4c0ac010dd69815800981580118158009baa00413232324a0605600460560026ea8010c0a0008c0a0004dd500111191919299981219b87480000084c8c8c928981500118150009baa004153330243370e90010010991919299981399b87480000085280a99981399b87480080084cdc49bad302a004375a60540022944c0a8008c0a8004dd50020991919299981399b87480100085288a50302a002302a0013754008604e004604e0026ea8009300103d87a80002301a22533302100114a02a66604066ebcc08c00400c528898011811000919980c91129998108010800899b803300330220020014800800520002323376060400026040603e00260406ea800530106d8799f0001ff00223333009371e0044944dc3a400400244646464a66603a66e1d200200214a0266e3cdd71810000802181000118100009baa0022323232533301b3370e90000010a5014a2603c004603c0026ea80048c8c8c94ccc068cdc3a400000426eb8c07400458c074008c074004dd5180d1801180b0009180c180c00091119809980a1191929980599baf301d0020061333007375c603a0026eb8c074c070004dd5980e980e001180c002180b80080091119998021b8f003371e0046e1d20020012222333012222533301a00214a0266010600260380046600660360040020024a66602e600a6eb8c0700044ccc04c8894ccc06c0085280998049800980e80119801980e0010009bab301b001253330185330093005375c603a002260086eb4c0700045288a5014a044601266ebcc00c008c00c0048cdd2999808800a40049000004911998088010008018a502225333011001161533301030063371e6eb8c054c04c0040084cc00c008c0480044c94ccc048004584cc01400cdd7180b180a0009bab30143013001223374a9000198029ba900233005375200200c910114556e626f6e6465645374616b696e67546f6b656e002533300b00114a029455d025eb8088c8c034c030c024004cc014c018c00c00800488cdc79bae300b3007001002223300330043005323232533300a3370e9001001098068008b180680118068009baa002001232300223300200200123002233002002001222533300700116153330063003300900113009001130023008001223375e004600e60060024600c6ea80055cd2ab9f5744ae8555cf2ab9d4c01a6d8799f1b00000189496a79701a0002bf201a0001d4c01a05f5e1001b0000048c27395000581c051581f71f927d8a9879c8ac3b285d623e4404561ced48a624f6ad40d8799f581c6f1a1f0c7ccf632cc9ff4b79687ed13ffe5b624cce288b364ebdce504441474958ff581cd50b6a6a28c960d26cb94280d16572504a08a17922ffc844aec732bd581c84abe361860a8525b9a8d039ac277809b84c61adfa711c6c7ed6e71fff0001";
        String scriptHash = "bf3050a428c7572551b5389d6ad96c5f8d9fbf89545800543e3b0f8a";
        PlutusScript plutusScript = PlutusUtil.getPlutusScript(scriptHash, cborHex).get();

        assertThat(plutusScript).isNotNull();
        assertThat(plutusScript).isInstanceOf(PlutusV1Script.class);
    }

    @Test
    void getPlutusScript_v1_singleEncoded() {
        String cborHex = "59236401000033232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323222223333222232323232323232323232323232323232323232323253330493370e90000010a99982499999811182600700c899991128008a5114a029404ccc88940045280a5114a02666444a00229405280a51153330493302c37526eb8c130018dd618260068a4c2c2c2a66609266e1d200400213232533304b53303c3302e37526eb8c13800cdd61827007899b87302f3758609c01e9001099191919299982799b874800000854ccc13ccdd798290029829000899191919191919191919191919299982e1822982f8008a99982e1822982f982f0048a99982e19b8f323232533305f3370e900000109bae30620011630620023062001375460be0106eb8c17c01c54ccc170ccc124dd7182f80b8289bab305f00c1533305c3375e60be01260be60bc0022930b0b0b0b0b182e800982e000982d800982d000982c800982c000982a191919299982c19b87480080084c16c00458c16c008c16c004dd51919191919829182199182e982e182c8009982a982b119baf305d3059001305d305c00c375860b804800ea6660b066e1d2000002132323232324994ccc17400452616305d002305d001305b002305b001153330583370e9001001099191924ca6660b60022930b182d801182d8008a99982c19b87480100084c8c8c8c926533305c001149858c17000cdd7000982d8008b182d801182d8009baa3304e303f3230593058305500133051305223375e60b260aa00260b260b00106eb0c16008000cc8c8c94ccc15ccdc3a400000420022c60b400460b40026ea808cc8c8c94ccc158cdc3a400000420022c60b200460b20026ea8c8c8c8c8cc140c104ccc10cc168020018dd6182d010802a99982b19b87480000084c8c8c8c8c926533305b001149858c16c008c16c004c164008c16400454ccc158cdc3a4004004264646493299982c8008a4c2c60b200460b20022a6660ac66e1d20040021323232324994ccc16800452616305a003375c00260b20022c60b200460b20026ea8cc130c0f4ccc0fcc158010008dd6182b00e8009bac305501533045375c60a801808c60a4002609c60a460a200a2a66609e66ebcc148014c148c14400454ccc13ccc0d8dd7182918288051bab30523051304e305230510051533304f33303c375c60a460a201400c6eacc148c144c138c148c14401452616161533304f32323253330523370e90020010a99982919b8f375c60aa0026e50dd7182a8050a511614a060aa00460aa0026ea8078526161533304f3370e900200109919191919191919299982b98269820182d0008a99982b99b8f375c60b400e6e50dd7182d0078a99982b99b87332232323233303122533305e3371e0086eb8c18c0044ccc0cc894ccc180cdc78029bae30650011337000046eb4c1900044008008dd598310008801240000086eb8c178c174008dd7182e800982c001182d009991bab305b305a30570013305330542323375e01c0026460b860b000260b660ae0026eb0c168084c8cdc199b81375a60b600266e14dd6982d8009bad305b305a001375a60b660b400260ac646464646606666e0c008cccc15c0c400800520023370600266660ae062004002900119b82375a60ba60b80066eb4c174c170008cdc019b82375a60b80046eb4c170c16c004cdc11bad305c001375a60b860b600460ae60b600a60ac6605e6eb4c1680192002153330573375e60b401a60b40122a6660ae6607c6eb8c168c164048dd5982d182c982b182d182c8068a99982b9998221bae305a305901200e375660b460b260ac60b460b201a2930b0b0a99982b991919299982d19b874801000854ccc168cdc79bae305d00137286eb8c1740485288b0a50305d002305d001375404c2930b0b0b0b182c000982b800982b000982a800982a00098298009827991919299982999b87480080084c15800458c158008c158004dd51919191919826981f19182c182b982a000998281828919baf305830540013058007375860ae03e00aa6660a666e1d2000002132323232324994ccc160004526163058002305800130560023056001153330533370e9001001099191924ca6660ac0022930b182b001182b0008a99982999b87480100084c8c8c8c9265333057001149858c15c00cdd7000982b0008b182b001182b0009baa33049303a323054305330500013304c304d23375e60a860a000260a80066eb0c14c06c004dd618290090a99982799baf30520053052001132323232323232323232323232323232323232323232323253330673050306a001153330673304e375c60d460d20446eacc1a805c54ccc19ccc13cc1a8c1a403cdd718350038a99983399baf306a3069008306a3069001153330675330583375e60d401c60d402a2a660b066ebcc1a8034c1a805054cc160cdd7983500618350098a9982c19baf306a00b306a01215330583375e60d401460d40222a660b066ebcc1a8024c1a80404cdd7983500418350078a4c2c2c2c2c2c60d000260ce00260cc00260ca00260c800260c600260be646464a6660c666e1d2002002130660011630660023066001375464646464660ba609c6460d060ce60c8002660c060c2466ebcc1a0c190004c1a0c19c05cdd61833817809a99983199b87480000084c8c8c8c8c9265333068001149858c1a0008c1a0004c198008c19800454ccc18ccdc3a400400426464649329998330008a4c2c60cc00460cc0022a6660c666e1d20040021323232324994ccc19c004526163067003375c00260cc0022c60cc00460cc0026ea8cc164c128c8c190c18cc180004cc170c1748cdd798321830000983218318099bac306302b00f30610013060001305f001305e001305d001305c0013058323232533305c3370e90010010982f8008b182f801182f8009baa32323232330563047333049306000e333059050375c60c060be0306eacc180034dd61830013806299982e19b87480000084c8c8c8c8c9265333061001149858c184008c184004c17c008c17c00454ccc170cdc3a4004004264646493299982f8008a4c2c60be00460be0022a6660b866e1d20040021323232324994ccc180004526163060003375c00260be0022c60be00460be0026ea8cc148c10cccc114c170028ccc154130dd7182e182d80a1bab305c009375860b804601060b400260b200260b000260ae00260ac00260aa00260a2646464a6660aa66e1d200200213058001163058002305800137540426eb0c150050c148004c138c148c14401454ccc13ccdd79829002982918288008a9998279981b1bae3052305100a375660a460a2609c60a460a200a2a66609e6660786eb8c148c144028018dd5982918289827182918288028a4c2c2c2a66609e646464a6660a466e1d2004002153330523371e6eb8c154004dca1bae305500a14a22c2940c154008c154004dd500f0a4c2c60a400460a40026ea8c13cc138010cdd2a4000660846ea4dd718270018218b1824998229826982600b1bac304d01537286eb8c13000454ccc124ccccc088c1300380644ccc88940085288a5014a02666444a00429405288a501333222500214a02940528899192999825a9981e198171ba9375c609c0046eb0c13803c4cdc398179bac304e00f480084c94ccc130cdc4240006eb4c13c0104c8c8c8c8c94ccc144cdc3a40040042a6660a2608e660706eb8c150c14c030dd5982a00c899192999829991919299982b19b874801000854ccc158cdc79bae305900100b14a22c2940c164008c164004dd50110a4c2646464646464646464646464646464a6660c4a660a6609660ca0102609660ca0022a6660c466e3cdd7183280700b8a99983119b8f375c60ca00e02e2a6660c466e1cdd6983280299b80375a60ca0186eb4c19406854ccc188cdc39bad3065006337006eb4c194034dd6983280d0a99983129982999b89375a60ca0426eb4c1940184cdc49bad3065006375a60ca0402a6660c4a660a666ebcc19402cc19401054cc14ccdd7983280518328018a9982999baf3065009306500213375e60ca60c801060ca60c80022a6660c466660a06e3cdd7183280b1b8f375c60ca60c802c6e1cdd698328031bab3065306430613067533306301516132533306400113048306601616306401514985858585858585858c18c004c188004c184004c180004c17c004c178004c168c8c8c94ccc178cdc3a4004004260c20022c60c200460c20026ea8c8c8c8c8cc160c124ccc12cc188038030dd618310149bac3062022533305e3370e90000010991919191924ca6660c60022930b18318011831800983080118308008a99982f19b87480080084c8c8c9265333061001149858c184008c18400454ccc178cdc3a40080042646464649329998310008a4c2c60c40066eb8004c18400458c184008c184004dd51982a1822999823982f0050041bac305e025375860bc03c60b800260b600260b400260b200260b000260ae00260a6646464a6660ae66e1d20020021305a00116305a002305a00137540466608e6eb8c158c154038020c150004c140c150c14c01c5854ccc144cc0e0dd7182a18298061bab305401915333051333303f371e6eb8c150014dc79bae30543053005370e6eb4c150024dd5982a18299828182b29998290020b09929998298008981b982a8028b182980209919191919191919299982c99b87480000084c8c8c8c8c8c8c8c8c94ccc1894cc14cc12cc194c1900204c12cc194c19002454ccc1894cc14ccdc39bad3065005375a60ca034266e1cdd698328031bad306501a153330623371e6eb8c19401c05c54ccc188c12cc19400454ccc1894cc14ccdc49bad3065021375a60ca00c266e24dd698328031bad3065020153330625330533375e60ca0080902a660a666e1cdd69832801a4000266e1cdd69832801240002a6660c466609e6eb8c19407415cdd598328080a99983119baf3065018306500a153330623304a3065009375c60ca00e2646464a6660ca66e1d200200215333065304e306830670041498584c94ccc198cdc81bae306900b001153330663304e3069306800500114985858dd71834000983400118340009baa30650081616161616161616163063001306200130610013060001305f001305e001305a323232533305e3370e9001001098308008b183080118308009baa3232323233058304933304b306200e00b375860c4052014a6660bc66e1d2000002132323232324994ccc18c0045261630630023063001306100230610011533305e3370e9001001099191924ca6660c20022930b183080118308008a99982f19b87480100084c8c8c8c9265333062001149858c18800cdd700098308008b183080118308009baa330543045333047305e00a007375860bc04a00c646464a6660ba66e1d2000002100116306000230600013754052646464a6660b866e1d2000002100116305f002305f001375464646464660ac608e66609260c00180146eb0c18009c0214ccc170cdc3a4000004264646464649329998308008a4c2c60c200460c200260be00460be0022a6660b866e1d200200213232324994ccc17c00452616305f002305f0011533305c3370e900200109919191924ca6660c00022930b18300019bae001305f00116305f002305f0013754660a4608666608a60b801000c6eb0c17008c01054ccc164cdc3a40040042646464646464646464646464646464646464646464a6660dc60ae60e201e2a6660dca660be66e1cdd698388029bad307102613370e6eb4c1c4018dd698388130a99983719b8f375c60e200e0462a6660dc60ae60e20022a6660dca660be66e24dd698388169bad30710061337126eb4c1c4018dd698388160a99983729982f99baf3071004054153305f3370e6eb4c1c400d200013370e6eb4c1c400920001533306e53305f3375e60e202a60e201c2a660be66ebcc1c4050c1c403454cc17ccdd7983880998388060a9982f99baf3071012307100b153305f3375e60e202260e20142a660be66ebcc1c4040c1c40244cdd7983880798388040a9998371982a9bae30713070029375660e20382a6660dc66ebcc1c4090c1c405854ccc1b8cc158c1c4c1c0020dd718388038a9998371982b18389838000991919299983899b87480000084dd7183a0008b183a001183a0009baa3071307000f1533306e53305f337206eb8c1c4054dd71838803899b90375c60e200e646464a6660e266e1d20000021375c60e80022c60e800460e80026ea8c1c4c1c003c526161616161616161616161616306f001306e001306d001306c001306b001306a0013066323232533306a3370e9001001098368008b183680118368009baa32323232330643055333057306e01a017375860dc06a02ca6660d466e1d2000002132323232324994ccc1bc00452616306f002306f001306d002306d0011533306a3370e9001001099191924ca6660da0022930b183680118368008a99983519b87480100084c8c8c8c926533306e001149858c1b800cdd700098368008b183680118368009baa330603051333053306a016013375860d406202460d000260ce00260cc00260ca00260c800260c600260be646464a6660c666e1d2002002130660011630660023066001375464646464660ba609c6660a060ce0266660c00ae6eb8c19cc19807cdd598338091bac306702e00f53330633370e90000010991919191924ca6660d00022930b18340011834000983300118330008a99983199b87480080084c8c8c9265333066001149858c198008c19800454ccc18ccdc3a40080042646464649329998338008a4c2c60ce0066eb8004c19800458c198008c198004dd51982c9825199826183180799982e0299bae3063306201b375660c601c6eb0c18c0a802cc184004c180004c17c004c178004c174004c170004c160c8c8c94ccc170cdc3a4004004260be0022c60be00460be0026ea80a04c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c94ccc1bcc160c1c803c54ccc1bd4cc180cdc39bad3072005375a60e404e266e1cdd698390031bad30720271533306f3371e6eb8c1c801c09054ccc1bcc160c1c800454ccc1bd4cc180cdc49bad307202e375a60e400c266e24dd698390031bad307202d1533306f5330603375e60e40080aa2a660c066e1cdd69839001a4000266e1cdd69839001240002a6660dea660c066ebcc1c8054c1c803854cc180cdd7983900a18390068a9983019baf3072013307200c15330603375e60e402460e40162a660c066ebcc1c8044c1c802854cc180cdd798390081839004899baf307200f30720081533306f33056375c60e460e20546eacc1c807454ccc1bccdd7983901280b0a999837982c183918388078a9998379982b983918388041bae30720071533306f3058307230710011533306f337206eb8c1c8038dd718390038a4c2c2c2c2c2c2c2c2c2c2c2c2c2c60e000260de00260dc00260da00260d800260d600260ce646464a6660d666e1d20020021306e00116306e002306e001375464646464660ca60ac6660b060de0360306eb0c1bc0d805d4ccc1accdc3a4000004264646464649329998380008a4c2c60e000460e000260dc00460dc0022a6660d666e1d200200213232324994ccc1b800452616306e002306e0011533306b3370e900200109919191924ca6660de0022930b18378019bae001306e00116306e002306e0013754660c260a46660a860d602e0286eb0c1ac0c804cc1a4004c1a0004c19c004c198004c194004c190004c180c8c8c94ccc190cdc3a4004004260ce0022c60ce00460ce0026ea8c8c8c8c8cc178c13cccc144c1a0050ccc184160dd7183418338101bab3068013375860d005e020a6660c866e1d2000002132323232324994ccc1a4004526163069002306900130670023067001153330643370e9001001099191924ca6660ce0022930b183380118338008a99983219b87480100084c8c8c8c9265333068001149858c1a000cdd700098338008b183380118338009baa3305a304b33304d306401033305d054375c60c860c60386eacc19003cdd61832015806183100098308009830000982f800982f000982e800982c991919299982e99b87480080084c18000458c180008c180004dd5014982e000982e001182e0009baa3059006375860b0030660906eb8c15cc15803c024cc11cdd7182b007024182a0009828182a18298038b0b182a001182a0009baa3051305000533304922253330510011048133300230530012330480013300400330530021330030023052001232533304f30453375e60a40026460a6609e00260a460a200a244a0022646464a6660a466e1d2000002153330523232323253330563370e90020010a99982b19b8f375c60b2002016294458528182c801182c8009baa3232323200553330563370e90000010991919191924ca6660b60022930b182d801182d800982c801182c8008a99982b19b87480080084c8c8c9265333059001149858c164008c16400454ccc158cdc3a400800426464646493299982d0008a4c2c60b40066eb8004c16400458c164008c164004dd5000998259bae3055001375860aa02a24460046466e9520003304c0083304c00104d3304d375c60ae0066eb0c15c05c489400458c154008c154004dd518291828982880098268009bac3050017304b304f0081637286eb8c13800858c124cc114c134c130058dd6182680a98258008b182600118260009baa0143047001304600130450013044001304300130420013041001303d00e303f001303e001303d001303c001303b001303a001303900130380013034303800130330013232323200853330333370e9000001099191919191919191919191919191919191919191919191919191924ca66609c0022930b18270019bae001304d001304b003375c002609400260900046090002608c0066eb8004c114004c10c00cdd6800982100098200019bad001303f001303d003375a002607800260740066eb4004c0e4004c0dc00cdd6800981b0008b181b001181b0009baa0043232323200753330333370e90000010991919191924ca6660700022930b181c001181c000981b001181b0008a99981999b87480080084c8c8c9265333036001149858c0d8008c0d800454ccc0cccdc3a400800426464646493299981b8008a4c2c606e0066eb8004c0d800458c0d8008c0d8004dd500199191919003299981999b87480000084c926533303400114985854ccc0cccdc3a4004004264646464646464646493299981e0008a4c2c6078004607800260740066eb8004c0e4004c0dc00cdd6800981b0008a99981999b87480100084c8c8c8c8c8c9265333039001149858c0e4008c0e4004c0dc00cdd7000981b0008b181b001181b0009baa002001230282225333030001100213300333004002303200130310012222323253330303370e00a008266e0801400c54ccc0c000854ccc0c00044cdc119980319b8300548010cdc1802240080069002099980319b830054801001000c54ccc0c00044ccc018014cdc1802240080062a66606066e200140104ccc018cdc199b810040054801001400c4ccc018cdc199b810050044801001000cc01800cc01400c8cdc399b85001480112000223374a9000198109ba800233021375000204444646464646464646464646464a66606a6464a6605066022607400460740022660246074607200260746072004606a01e606866e9520003302c3374a90001981619ba5480000b4cc0b005c0b4cc0b0cdd2a40006605866e9520023302c375000805a66058604a9400b40b44889400c54ccc0d4cc88c00888888c8c8c8c94cc0c4cdc499b8132323253330433370e900100109bad3046001163046002304600137546086004646464a66608666e1d20020021375a608c0022c608c004608c0026ea8c10c00ccdc08030038a9981899802929981919b89480000084cdc4001000899b894800000454cc0c4cdc499b803370001266e0800402001cc8c8c94ccc10ccdc3a400400426eb4c11800458c118008c118004dd51821801899b8932323253330433370e900100109bad304600116304600230460013754608600466e00cdc000499b820010080063370866e04c8c8c94ccc108cdc3a400400426eb4c11400458c114008c114004dd51821001004003981e98209820001181e1820000981d8031199998008028012400000844a00201c2444a0042a66606a664460044444464646464a6606266e24cdc0991919299982199b87480080084dd698230008b182300118230009baa304300232323253330433370e900100109bad304600116304600230460013754608600666e0401801c54cc0c4cc01494cc0c8cdc4a4000004266e200080044cdc4a40000022a6606266e24cdc019b800093370400201000e646464a66608666e1d20020021375a608c0022c608c004608c0026ea8c10c00c4cdc4991919299982199b87480080084dd698230008b182300118230009baa30430023370066e00024cdc100080400319b8433702646464a66608466e1d20020021375a608a0022c608a004608a0026ea8c10800802001cc0f4c104c100008c0f0c100004c0ec0188ccccc004014008010cdc0002001912800807091128008b19b80002001375a606c0106eb4c0d4020dd6981a00418190009818800981800098178009817000981680098160009814000911919299981519b8733009302d002302d001480005288a99981519b8733009302d002302d0014800854cc018c020c0b4c0b00084c080c020c0b4c0b000454ccc0a8cdc39980498168011816800a4008294058c0a0008c09c00888c8c94ccc0a4cdc39980418160011816000a4000294454ccc0a4cdc39980418160011816000a40042a6600a600e605860560022603e600e605860560042a66605266e1ccc020c0b0008c0b0005200414a02c604e004604c0044466604c00400600229448cdc398141baa00148008894ccc08ccc00c008004520001533302333004002001148008520042232323253330253370e90000010991919299981419b87480000085280a51302b002302b00137540082a66604a66e1d2002002132323253330283370e90000010a50153330283370e90020010a511337106eb4c0ac010dd69815800981580118158009baa00413232324a0605600460560026ea8010c0a0008c0a0004dd500111191919299981219b87480000084c8c8c928981500118150009baa004153330243370e90010010991919299981399b87480000085280a99981399b87480080084cdc49bad302a004375a60540022944c0a8008c0a8004dd50020991919299981399b87480100085288a50302a002302a0013754008604e004604e0026ea8009300103d87a80002301a22533302100114a02a66604066ebcc08c00400c528898011811000919980c91129998108010800899b803300330220020014800800520002323376060400026040603e00260406ea800530106d8799f0001ff00223333009371e0044944dc3a400400244646464a66603a66e1d200200214a0266e3cdd71810000802181000118100009baa0022323232533301b3370e90000010a5014a2603c004603c0026ea80048c8c8c94ccc068cdc3a400000426eb8c07400458c074008c074004dd5180d1801180b0009180c180c00091119809980a1191929980599baf301d0020061333007375c603a0026eb8c074c070004dd5980e980e001180c002180b80080091119998021b8f003371e0046e1d20020012222333012222533301a00214a0266010600260380046600660360040020024a66602e600a6eb8c0700044ccc04c8894ccc06c0085280998049800980e80119801980e0010009bab301b001253330185330093005375c603a002260086eb4c0700045288a5014a044601266ebcc00c008c00c0048cdd2999808800a40049000004911998088010008018a502225333011001161533301030063371e6eb8c054c04c0040084cc00c008c0480044c94ccc048004584cc01400cdd7180b180a0009bab30143013001223374a9000198029ba900233005375200200c910114556e626f6e6465645374616b696e67546f6b656e002533300b00114a029455d025eb8088c8c034c030c024004cc014c018c00c00800488cdc79bae300b3007001002223300330043005323232533300a3370e9001001098068008b180680118068009baa002001232300223300200200123002233002002001222533300700116153330063003300900113009001130023008001223375e004600e60060024600c6ea80055cd2ab9f5744ae8555cf2ab9d4c01a6d8799f1b00000189496a79701a0002bf201a0001d4c01a05f5e1001b0000048c27395000581c051581f71f927d8a9879c8ac3b285d623e4404561ced48a624f6ad40d8799f581c6f1a1f0c7ccf632cc9ff4b79687ed13ffe5b624cce288b364ebdce504441474958ff581cd50b6a6a28c960d26cb94280d16572504a08a17922ffc844aec732bd581c84abe361860a8525b9a8d039ac277809b84c61adfa711c6c7ed6e71fff0001";
        String scriptHash = "bf3050a428c7572551b5389d6ad96c5f8d9fbf89545800543e3b0f8a";
        PlutusScript plutusScript = PlutusUtil.getPlutusScript(scriptHash, cborHex).get();

        assertThat(plutusScript).isNotNull();
        assertThat(plutusScript).isInstanceOf(PlutusV1Script.class);
    }

    @Test
    void getPlutusScript_v1_cborHex_version() {
        String cborHex = "59236759236401000033232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323222223333222232323232323232323232323232323232323232323253330493370e90000010a99982499999811182600700c899991128008a5114a029404ccc88940045280a5114a02666444a00229405280a51153330493302c37526eb8c130018dd618260068a4c2c2c2a66609266e1d200400213232533304b53303c3302e37526eb8c13800cdd61827007899b87302f3758609c01e9001099191919299982799b874800000854ccc13ccdd798290029829000899191919191919191919191919299982e1822982f8008a99982e1822982f982f0048a99982e19b8f323232533305f3370e900000109bae30620011630620023062001375460be0106eb8c17c01c54ccc170ccc124dd7182f80b8289bab305f00c1533305c3375e60be01260be60bc0022930b0b0b0b0b182e800982e000982d800982d000982c800982c000982a191919299982c19b87480080084c16c00458c16c008c16c004dd51919191919829182199182e982e182c8009982a982b119baf305d3059001305d305c00c375860b804800ea6660b066e1d2000002132323232324994ccc17400452616305d002305d001305b002305b001153330583370e9001001099191924ca6660b60022930b182d801182d8008a99982c19b87480100084c8c8c8c926533305c001149858c17000cdd7000982d8008b182d801182d8009baa3304e303f3230593058305500133051305223375e60b260aa00260b260b00106eb0c16008000cc8c8c94ccc15ccdc3a400000420022c60b400460b40026ea808cc8c8c94ccc158cdc3a400000420022c60b200460b20026ea8c8c8c8c8cc140c104ccc10cc168020018dd6182d010802a99982b19b87480000084c8c8c8c8c926533305b001149858c16c008c16c004c164008c16400454ccc158cdc3a4004004264646493299982c8008a4c2c60b200460b20022a6660ac66e1d20040021323232324994ccc16800452616305a003375c00260b20022c60b200460b20026ea8cc130c0f4ccc0fcc158010008dd6182b00e8009bac305501533045375c60a801808c60a4002609c60a460a200a2a66609e66ebcc148014c148c14400454ccc13ccc0d8dd7182918288051bab30523051304e305230510051533304f33303c375c60a460a201400c6eacc148c144c138c148c14401452616161533304f32323253330523370e90020010a99982919b8f375c60aa0026e50dd7182a8050a511614a060aa00460aa0026ea8078526161533304f3370e900200109919191919191919299982b98269820182d0008a99982b99b8f375c60b400e6e50dd7182d0078a99982b99b87332232323233303122533305e3371e0086eb8c18c0044ccc0cc894ccc180cdc78029bae30650011337000046eb4c1900044008008dd598310008801240000086eb8c178c174008dd7182e800982c001182d009991bab305b305a30570013305330542323375e01c0026460b860b000260b660ae0026eb0c168084c8cdc199b81375a60b600266e14dd6982d8009bad305b305a001375a60b660b400260ac646464646606666e0c008cccc15c0c400800520023370600266660ae062004002900119b82375a60ba60b80066eb4c174c170008cdc019b82375a60b80046eb4c170c16c004cdc11bad305c001375a60b860b600460ae60b600a60ac6605e6eb4c1680192002153330573375e60b401a60b40122a6660ae6607c6eb8c168c164048dd5982d182c982b182d182c8068a99982b9998221bae305a305901200e375660b460b260ac60b460b201a2930b0b0a99982b991919299982d19b874801000854ccc168cdc79bae305d00137286eb8c1740485288b0a50305d002305d001375404c2930b0b0b0b182c000982b800982b000982a800982a00098298009827991919299982999b87480080084c15800458c158008c158004dd51919191919826981f19182c182b982a000998281828919baf305830540013058007375860ae03e00aa6660a666e1d2000002132323232324994ccc160004526163058002305800130560023056001153330533370e9001001099191924ca6660ac0022930b182b001182b0008a99982999b87480100084c8c8c8c9265333057001149858c15c00cdd7000982b0008b182b001182b0009baa33049303a323054305330500013304c304d23375e60a860a000260a80066eb0c14c06c004dd618290090a99982799baf30520053052001132323232323232323232323232323232323232323232323253330673050306a001153330673304e375c60d460d20446eacc1a805c54ccc19ccc13cc1a8c1a403cdd718350038a99983399baf306a3069008306a3069001153330675330583375e60d401c60d402a2a660b066ebcc1a8034c1a805054cc160cdd7983500618350098a9982c19baf306a00b306a01215330583375e60d401460d40222a660b066ebcc1a8024c1a80404cdd7983500418350078a4c2c2c2c2c2c60d000260ce00260cc00260ca00260c800260c600260be646464a6660c666e1d2002002130660011630660023066001375464646464660ba609c6460d060ce60c8002660c060c2466ebcc1a0c190004c1a0c19c05cdd61833817809a99983199b87480000084c8c8c8c8c9265333068001149858c1a0008c1a0004c198008c19800454ccc18ccdc3a400400426464649329998330008a4c2c60cc00460cc0022a6660c666e1d20040021323232324994ccc19c004526163067003375c00260cc0022c60cc00460cc0026ea8cc164c128c8c190c18cc180004cc170c1748cdd798321830000983218318099bac306302b00f30610013060001305f001305e001305d001305c0013058323232533305c3370e90010010982f8008b182f801182f8009baa32323232330563047333049306000e333059050375c60c060be0306eacc180034dd61830013806299982e19b87480000084c8c8c8c8c9265333061001149858c184008c184004c17c008c17c00454ccc170cdc3a4004004264646493299982f8008a4c2c60be00460be0022a6660b866e1d20040021323232324994ccc180004526163060003375c00260be0022c60be00460be0026ea8cc148c10cccc114c170028ccc154130dd7182e182d80a1bab305c009375860b804601060b400260b200260b000260ae00260ac00260aa00260a2646464a6660aa66e1d200200213058001163058002305800137540426eb0c150050c148004c138c148c14401454ccc13ccdd79829002982918288008a9998279981b1bae3052305100a375660a460a2609c60a460a200a2a66609e6660786eb8c148c144028018dd5982918289827182918288028a4c2c2c2a66609e646464a6660a466e1d2004002153330523371e6eb8c154004dca1bae305500a14a22c2940c154008c154004dd500f0a4c2c60a400460a40026ea8c13cc138010cdd2a4000660846ea4dd718270018218b1824998229826982600b1bac304d01537286eb8c13000454ccc124ccccc088c1300380644ccc88940085288a5014a02666444a00429405288a501333222500214a02940528899192999825a9981e198171ba9375c609c0046eb0c13803c4cdc398179bac304e00f480084c94ccc130cdc4240006eb4c13c0104c8c8c8c8c94ccc144cdc3a40040042a6660a2608e660706eb8c150c14c030dd5982a00c899192999829991919299982b19b874801000854ccc158cdc79bae305900100b14a22c2940c164008c164004dd50110a4c2646464646464646464646464646464a6660c4a660a6609660ca0102609660ca0022a6660c466e3cdd7183280700b8a99983119b8f375c60ca00e02e2a6660c466e1cdd6983280299b80375a60ca0186eb4c19406854ccc188cdc39bad3065006337006eb4c194034dd6983280d0a99983129982999b89375a60ca0426eb4c1940184cdc49bad3065006375a60ca0402a6660c4a660a666ebcc19402cc19401054cc14ccdd7983280518328018a9982999baf3065009306500213375e60ca60c801060ca60c80022a6660c466660a06e3cdd7183280b1b8f375c60ca60c802c6e1cdd698328031bab3065306430613067533306301516132533306400113048306601616306401514985858585858585858c18c004c188004c184004c180004c17c004c178004c168c8c8c94ccc178cdc3a4004004260c20022c60c200460c20026ea8c8c8c8c8cc160c124ccc12cc188038030dd618310149bac3062022533305e3370e90000010991919191924ca6660c60022930b18318011831800983080118308008a99982f19b87480080084c8c8c9265333061001149858c184008c18400454ccc178cdc3a40080042646464649329998310008a4c2c60c40066eb8004c18400458c184008c184004dd51982a1822999823982f0050041bac305e025375860bc03c60b800260b600260b400260b200260b000260ae00260a6646464a6660ae66e1d20020021305a00116305a002305a00137540466608e6eb8c158c154038020c150004c140c150c14c01c5854ccc144cc0e0dd7182a18298061bab305401915333051333303f371e6eb8c150014dc79bae30543053005370e6eb4c150024dd5982a18299828182b29998290020b09929998298008981b982a8028b182980209919191919191919299982c99b87480000084c8c8c8c8c8c8c8c8c94ccc1894cc14cc12cc194c1900204c12cc194c19002454ccc1894cc14ccdc39bad3065005375a60ca034266e1cdd698328031bad306501a153330623371e6eb8c19401c05c54ccc188c12cc19400454ccc1894cc14ccdc49bad3065021375a60ca00c266e24dd698328031bad3065020153330625330533375e60ca0080902a660a666e1cdd69832801a4000266e1cdd69832801240002a6660c466609e6eb8c19407415cdd598328080a99983119baf3065018306500a153330623304a3065009375c60ca00e2646464a6660ca66e1d200200215333065304e306830670041498584c94ccc198cdc81bae306900b001153330663304e3069306800500114985858dd71834000983400118340009baa30650081616161616161616163063001306200130610013060001305f001305e001305a323232533305e3370e9001001098308008b183080118308009baa3232323233058304933304b306200e00b375860c4052014a6660bc66e1d2000002132323232324994ccc18c0045261630630023063001306100230610011533305e3370e9001001099191924ca6660c20022930b183080118308008a99982f19b87480100084c8c8c8c9265333062001149858c18800cdd700098308008b183080118308009baa330543045333047305e00a007375860bc04a00c646464a6660ba66e1d2000002100116306000230600013754052646464a6660b866e1d2000002100116305f002305f001375464646464660ac608e66609260c00180146eb0c18009c0214ccc170cdc3a4000004264646464649329998308008a4c2c60c200460c200260be00460be0022a6660b866e1d200200213232324994ccc17c00452616305f002305f0011533305c3370e900200109919191924ca6660c00022930b18300019bae001305f00116305f002305f0013754660a4608666608a60b801000c6eb0c17008c01054ccc164cdc3a40040042646464646464646464646464646464646464646464a6660dc60ae60e201e2a6660dca660be66e1cdd698388029bad307102613370e6eb4c1c4018dd698388130a99983719b8f375c60e200e0462a6660dc60ae60e20022a6660dca660be66e24dd698388169bad30710061337126eb4c1c4018dd698388160a99983729982f99baf3071004054153305f3370e6eb4c1c400d200013370e6eb4c1c400920001533306e53305f3375e60e202a60e201c2a660be66ebcc1c4050c1c403454cc17ccdd7983880998388060a9982f99baf3071012307100b153305f3375e60e202260e20142a660be66ebcc1c4040c1c40244cdd7983880798388040a9998371982a9bae30713070029375660e20382a6660dc66ebcc1c4090c1c405854ccc1b8cc158c1c4c1c0020dd718388038a9998371982b18389838000991919299983899b87480000084dd7183a0008b183a001183a0009baa3071307000f1533306e53305f337206eb8c1c4054dd71838803899b90375c60e200e646464a6660e266e1d20000021375c60e80022c60e800460e80026ea8c1c4c1c003c526161616161616161616161616306f001306e001306d001306c001306b001306a0013066323232533306a3370e9001001098368008b183680118368009baa32323232330643055333057306e01a017375860dc06a02ca6660d466e1d2000002132323232324994ccc1bc00452616306f002306f001306d002306d0011533306a3370e9001001099191924ca6660da0022930b183680118368008a99983519b87480100084c8c8c8c926533306e001149858c1b800cdd700098368008b183680118368009baa330603051333053306a016013375860d406202460d000260ce00260cc00260ca00260c800260c600260be646464a6660c666e1d2002002130660011630660023066001375464646464660ba609c6660a060ce0266660c00ae6eb8c19cc19807cdd598338091bac306702e00f53330633370e90000010991919191924ca6660d00022930b18340011834000983300118330008a99983199b87480080084c8c8c9265333066001149858c198008c19800454ccc18ccdc3a40080042646464649329998338008a4c2c60ce0066eb8004c19800458c198008c198004dd51982c9825199826183180799982e0299bae3063306201b375660c601c6eb0c18c0a802cc184004c180004c17c004c178004c174004c170004c160c8c8c94ccc170cdc3a4004004260be0022c60be00460be0026ea80a04c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c94ccc1bcc160c1c803c54ccc1bd4cc180cdc39bad3072005375a60e404e266e1cdd698390031bad30720271533306f3371e6eb8c1c801c09054ccc1bcc160c1c800454ccc1bd4cc180cdc49bad307202e375a60e400c266e24dd698390031bad307202d1533306f5330603375e60e40080aa2a660c066e1cdd69839001a4000266e1cdd69839001240002a6660dea660c066ebcc1c8054c1c803854cc180cdd7983900a18390068a9983019baf3072013307200c15330603375e60e402460e40162a660c066ebcc1c8044c1c802854cc180cdd798390081839004899baf307200f30720081533306f33056375c60e460e20546eacc1c807454ccc1bccdd7983901280b0a999837982c183918388078a9998379982b983918388041bae30720071533306f3058307230710011533306f337206eb8c1c8038dd718390038a4c2c2c2c2c2c2c2c2c2c2c2c2c2c60e000260de00260dc00260da00260d800260d600260ce646464a6660d666e1d20020021306e00116306e002306e001375464646464660ca60ac6660b060de0360306eb0c1bc0d805d4ccc1accdc3a4000004264646464649329998380008a4c2c60e000460e000260dc00460dc0022a6660d666e1d200200213232324994ccc1b800452616306e002306e0011533306b3370e900200109919191924ca6660de0022930b18378019bae001306e00116306e002306e0013754660c260a46660a860d602e0286eb0c1ac0c804cc1a4004c1a0004c19c004c198004c194004c190004c180c8c8c94ccc190cdc3a4004004260ce0022c60ce00460ce0026ea8c8c8c8c8cc178c13cccc144c1a0050ccc184160dd7183418338101bab3068013375860d005e020a6660c866e1d2000002132323232324994ccc1a4004526163069002306900130670023067001153330643370e9001001099191924ca6660ce0022930b183380118338008a99983219b87480100084c8c8c8c9265333068001149858c1a000cdd700098338008b183380118338009baa3305a304b33304d306401033305d054375c60c860c60386eacc19003cdd61832015806183100098308009830000982f800982f000982e800982c991919299982e99b87480080084c18000458c180008c180004dd5014982e000982e001182e0009baa3059006375860b0030660906eb8c15cc15803c024cc11cdd7182b007024182a0009828182a18298038b0b182a001182a0009baa3051305000533304922253330510011048133300230530012330480013300400330530021330030023052001232533304f30453375e60a40026460a6609e00260a460a200a244a0022646464a6660a466e1d2000002153330523232323253330563370e90020010a99982b19b8f375c60b2002016294458528182c801182c8009baa3232323200553330563370e90000010991919191924ca6660b60022930b182d801182d800982c801182c8008a99982b19b87480080084c8c8c9265333059001149858c164008c16400454ccc158cdc3a400800426464646493299982d0008a4c2c60b40066eb8004c16400458c164008c164004dd5000998259bae3055001375860aa02a24460046466e9520003304c0083304c00104d3304d375c60ae0066eb0c15c05c489400458c154008c154004dd518291828982880098268009bac3050017304b304f0081637286eb8c13800858c124cc114c134c130058dd6182680a98258008b182600118260009baa0143047001304600130450013044001304300130420013041001303d00e303f001303e001303d001303c001303b001303a001303900130380013034303800130330013232323200853330333370e9000001099191919191919191919191919191919191919191919191919191924ca66609c0022930b18270019bae001304d001304b003375c002609400260900046090002608c0066eb8004c114004c10c00cdd6800982100098200019bad001303f001303d003375a002607800260740066eb4004c0e4004c0dc00cdd6800981b0008b181b001181b0009baa0043232323200753330333370e90000010991919191924ca6660700022930b181c001181c000981b001181b0008a99981999b87480080084c8c8c9265333036001149858c0d8008c0d800454ccc0cccdc3a400800426464646493299981b8008a4c2c606e0066eb8004c0d800458c0d8008c0d8004dd500199191919003299981999b87480000084c926533303400114985854ccc0cccdc3a4004004264646464646464646493299981e0008a4c2c6078004607800260740066eb8004c0e4004c0dc00cdd6800981b0008a99981999b87480100084c8c8c8c8c8c9265333039001149858c0e4008c0e4004c0dc00cdd7000981b0008b181b001181b0009baa002001230282225333030001100213300333004002303200130310012222323253330303370e00a008266e0801400c54ccc0c000854ccc0c00044cdc119980319b8300548010cdc1802240080069002099980319b830054801001000c54ccc0c00044ccc018014cdc1802240080062a66606066e200140104ccc018cdc199b810040054801001400c4ccc018cdc199b810050044801001000cc01800cc01400c8cdc399b85001480112000223374a9000198109ba800233021375000204444646464646464646464646464a66606a6464a6605066022607400460740022660246074607200260746072004606a01e606866e9520003302c3374a90001981619ba5480000b4cc0b005c0b4cc0b0cdd2a40006605866e9520023302c375000805a66058604a9400b40b44889400c54ccc0d4cc88c00888888c8c8c8c94cc0c4cdc499b8132323253330433370e900100109bad3046001163046002304600137546086004646464a66608666e1d20020021375a608c0022c608c004608c0026ea8c10c00ccdc08030038a9981899802929981919b89480000084cdc4001000899b894800000454cc0c4cdc499b803370001266e0800402001cc8c8c94ccc10ccdc3a400400426eb4c11800458c118008c118004dd51821801899b8932323253330433370e900100109bad304600116304600230460013754608600466e00cdc000499b820010080063370866e04c8c8c94ccc108cdc3a400400426eb4c11400458c114008c114004dd51821001004003981e98209820001181e1820000981d8031199998008028012400000844a00201c2444a0042a66606a664460044444464646464a6606266e24cdc0991919299982199b87480080084dd698230008b182300118230009baa304300232323253330433370e900100109bad304600116304600230460013754608600666e0401801c54cc0c4cc01494cc0c8cdc4a4000004266e200080044cdc4a40000022a6606266e24cdc019b800093370400201000e646464a66608666e1d20020021375a608c0022c608c004608c0026ea8c10c00c4cdc4991919299982199b87480080084dd698230008b182300118230009baa30430023370066e00024cdc100080400319b8433702646464a66608466e1d20020021375a608a0022c608a004608a0026ea8c10800802001cc0f4c104c100008c0f0c100004c0ec0188ccccc004014008010cdc0002001912800807091128008b19b80002001375a606c0106eb4c0d4020dd6981a00418190009818800981800098178009817000981680098160009814000911919299981519b8733009302d002302d001480005288a99981519b8733009302d002302d0014800854cc018c020c0b4c0b00084c080c020c0b4c0b000454ccc0a8cdc39980498168011816800a4008294058c0a0008c09c00888c8c94ccc0a4cdc39980418160011816000a4000294454ccc0a4cdc39980418160011816000a40042a6600a600e605860560022603e600e605860560042a66605266e1ccc020c0b0008c0b0005200414a02c604e004604c0044466604c00400600229448cdc398141baa00148008894ccc08ccc00c008004520001533302333004002001148008520042232323253330253370e90000010991919299981419b87480000085280a51302b002302b00137540082a66604a66e1d2002002132323253330283370e90000010a50153330283370e90020010a511337106eb4c0ac010dd69815800981580118158009baa00413232324a0605600460560026ea8010c0a0008c0a0004dd500111191919299981219b87480000084c8c8c928981500118150009baa004153330243370e90010010991919299981399b87480000085280a99981399b87480080084cdc49bad302a004375a60540022944c0a8008c0a8004dd50020991919299981399b87480100085288a50302a002302a0013754008604e004604e0026ea8009300103d87a80002301a22533302100114a02a66604066ebcc08c00400c528898011811000919980c91129998108010800899b803300330220020014800800520002323376060400026040603e00260406ea800530106d8799f0001ff00223333009371e0044944dc3a400400244646464a66603a66e1d200200214a0266e3cdd71810000802181000118100009baa0022323232533301b3370e90000010a5014a2603c004603c0026ea80048c8c8c94ccc068cdc3a400000426eb8c07400458c074008c074004dd5180d1801180b0009180c180c00091119809980a1191929980599baf301d0020061333007375c603a0026eb8c074c070004dd5980e980e001180c002180b80080091119998021b8f003371e0046e1d20020012222333012222533301a00214a0266010600260380046600660360040020024a66602e600a6eb8c0700044ccc04c8894ccc06c0085280998049800980e80119801980e0010009bab301b001253330185330093005375c603a002260086eb4c0700045288a5014a044601266ebcc00c008c00c0048cdd2999808800a40049000004911998088010008018a502225333011001161533301030063371e6eb8c054c04c0040084cc00c008c0480044c94ccc048004584cc01400cdd7180b180a0009bab30143013001223374a9000198029ba900233005375200200c910114556e626f6e6465645374616b696e67546f6b656e002533300b00114a029455d025eb8088c8c034c030c024004cc014c018c00c00800488cdc79bae300b3007001002223300330043005323232533300a3370e9001001098068008b180680118068009baa002001232300223300200200123002233002002001222533300700116153330063003300900113009001130023008001223375e004600e60060024600c6ea80055cd2ab9f5744ae8555cf2ab9d4c01a6d8799f1b00000189496a79701a0002bf201a0001d4c01a05f5e1001b0000048c27395000581c051581f71f927d8a9879c8ac3b285d623e4404561ced48a624f6ad40d8799f581c6f1a1f0c7ccf632cc9ff4b79687ed13ffe5b624cce288b364ebdce504441474958ff581cd50b6a6a28c960d26cb94280d16572504a08a17922ffc844aec732bd581c84abe361860a8525b9a8d039ac277809b84c61adfa711c6c7ed6e71fff0001";
        PlutusScript plutusScript = PlutusUtil.getPlutusScript(cborHex, PlutusVersion.v1);

        assertThat(plutusScript).isInstanceOf(PlutusV1Script.class);
    }

    @Test
    void getPlutusScript_v2_cborHex_version() {
        String cborHex = "5903585903550100003323232323232323232323232323232323232322223232323232323253330153370e9000001099191919299980c99b874800000854ccc064cdc39998079bab301e30133018301e004375c603c0026eb8c078015200215333019332301322533301d00114a02a6646603a0022944c00cc0840044c008c07c0048cdd7980f980c8008079bac301e3018301e301800c149854cc07d241115554784f206e6f7420636f6e73756d65640016153301f01616153301f01716301f002301f0013754603660320026028010264646464a66603266e1d2000002153330193370e66601e6eacc078c04cc060c078010dd7180f0009bae301e00532337029000000a40042930a9980f80b0b0a9980f80b8b180f801180f8009baa301b30190013014008301b002301b001375400ca66602266e1d2000002132325333013337126e340052040132324994ccc054004526153301a016163016003153301901716375c002602c0022a66602266e1d2002002132325333013337126e340052040132324994ccc054004526153301a016163016003153301901716375c002602c0022a6602e92013f7265616368656420656e64206f662073756d207768696c65207374696c6c206e6f7420686176696e6720666f756e642074686520636f6e7374727563746f720016301700230170013754004444666600800490001199980280124000eb4dd5800801918011ba900122223300522533300f00110051533300e3375e602c602600200c26008602a602600226004602200200246460044660040040024600446600400400246014600400246012600400246010601000292103323034004901435061747465726e206d61746368206661696c75726520696e2027646f2720626c6f636b206174207372632f5368617265642f436865636b732e68733a33373a332d313900230093754002ae6955cfa481317074727946726f6d2850446174615265636f72645b5d293a206c697374206973206c6f6e676572207468616e207a65726f0057449201327074727946726f6d28546f6b656e4e616d65293a206d757374206265206174206d6f7374203332204279746573206c6f6e67005742ae7155cf2ab9d4c12bd8799fd8799f58200a61225b2d38afdea88fa3ed23002caadeb4a286d2b905f2e87733bbc9d9c282ff03ff0001";
        PlutusScript plutusScript = PlutusUtil.getPlutusScript(cborHex, PlutusVersion.v2);

        assertThat(plutusScript).isInstanceOf(PlutusV2Script.class);
    }
}
